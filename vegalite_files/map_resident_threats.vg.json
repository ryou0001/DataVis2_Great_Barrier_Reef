{
"$schema": "https://vega.github.io/schema/vega-lite/v5.json",
"width": 303,
"height": 360,
"title": { "text": "Great Barrier Reef" },
"projection": {"type": "mercator"},
"view": {"fill": "white"},
"layer": [
    {
    "data": {
        "url": "vegalite_files/maps/Great_Barrier_Reef_Marine_Park_Boundary_20_-1917278366387594965.json",
        "format": {"type": "topojson", "feature": "Great_Barrier_Reef_Marine_Park_Boundary_20_-1917278366387594965"}
    },
    "mark": {"type": "geoshape", "fill": "lightgray", "opacity": 0.5}
    },
    {
        "data": {
            "url": "vegalite_files/maps/STE_2021_AUST_GDA2020_surrounds.json",
            "format": {"type": "topojson", "feature": "STE_2021_AUST_GDA2020"}
        },
        "mark": {"type": "geoshape", "fill": "lightgray", "stroke": "darkgray"}
    },
    {
    "data": {
        "url": "vegalite_files/maps/STE_2021_AUST_GDA2020_QLD.json",
        "format": {"type": "topojson", "feature": "STE_2021_AUST_GDA2020"}
    },
    "mark": {"type": "geoshape", "fill": "white", "stroke": "darkgray"}
    },
    {
        "data": {
            "url": "vegalite_files/maps/NRM_regions_2020.json",
            "format": {"type": "topojson", "feature": "NRM_regions_2020"}
        },
        "transform": [{
            "lookup": "properties.NRM_REGION",
            "from": {
                "data": {"url": "vegalite_files/data/resident_threats.csv"},
                "key": "NRM",
                "fields": ["population", "perc_interviewed", "climate_change_total", "climate_change_perc"]
            }
        }],
        "mark": {
            "type": "geoshape", 
            "stroke": "darkgray",
            "opacity": 0.5
        },
        "encoding": {
            "color": {
                "field": "climate_change_perc",
                "type": "quantitative",
                "scale": {
                    "domain": [0,0.45]
                },
            "legend": {
                "title": "% of residents"
            }
            },
            "tooltip": [
                {"field": "properties.NRM_REGION", "type": "nominal", "title": "NRM Region"},
                {"field": "population", "type": "quantitative", "title": "Population", "format": ","},
                {"field": "perc_interviewed", "type": "quantitative", "title": "Percentage of population interviewed", "format": ".3%"},
                {"field": "climate_change_total", "type": "quantitative", "title": "Total number of interviewed residents concerned about threat"},
                {"field": "climate_change_perc", "type": "quantitative", "title": "Percentage of interviewed residents concerned about threat", "format": ".2%"}
            ]
        }
    },
    {
    "data": {
        "url": "vegalite_files/maps/GBR_reef.json",
        "format": {"type": "topojson", "feature": "TS_AIMS_NESP_Torres_Strait_Features_V1b_with_GBR_Features"}
    },
    "mark": {"type": "geoshape", "fill": "pink"}
    },
    {
    "data": {"values": [{"state": "QUEENSLAND", "x": 146, "y": -27.5}]},
    "mark": {"type": "text", "fontSize": 20, "color": "darkgray"},
    "encoding": {
        "text": {"field": "state", "type": "nominal"},
        "longitude": {"field": "x"}, 
        "latitude": {"field": "y"}}
    }
]
}