{
"$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "config": {"view": {"stroke": "transparent"}},
"data": {"url": "vegalite_files/data/tourist_numbers.csv"},
"padding": 0,
"transform": [
  {
    "joinaggregate": [{
      "op": "sum",
      "field": "visits",
      "as": "GBR_visits"
    }],
    "groupby": ["Quarter"]
  }
],
"vconcat": [
  {
    "title": { "text": "Tourist numbers at the GBR", "fontSize": 14 },
    "width": 678,
    "height": 400,
    "encoding": {
      "x": {"axis": {"title": "Time"}},
      "y": {"axis": {"title": "Number of tourist visits"}}
    },
    "layer": [
      {
        "data": {
          "values": [
            {"label": "Borders close due to COVID-19", "start": "Mar-Jun 2020", "end": "Jan-Mar 2021"},
            {"label": "Borders close due to COVID-19", "start": "Jul-Sep 2021", "end": "Jan-Mar 2022"},
            {"label": "Resident survey conducted", "type": "survey", "start": "Apr-Jun 2017", "end": "Jul-Sep 2017"}                 
        ]
        },
        "mark": "rect",
        "encoding": {
          "x": {"field": "start", "type": "temporal"},
          "x2": {"field": "end", "type": "temporal"},
          "opacity": {"value": 0.2},
          "color": {"field": "type"}
        }
      },
      {
        "data": {
          "values": [
            {"label": "Queensland borders closed"}
          ]},
          "mark": {
            "type": "text",
            "angle": -90,
            "fill": "black", 
            "align": "center", 
            "baseline": "middle",
            "dy": 35,
            "dx": 80,
            "fontSize": 13,
            "opacity": 0.5
          },
          "encoding": {
            "text": {"field": "label"}
        }
      },
      {
        "data": {
          "values": [
            {"label": "Queensland borders closed"}
          ]},
          "mark": {
            "type": "text",
            "angle": -90,
            "fill": "black", 
            "align": "center", 
            "baseline": "middle",
            "dy": 105,
            "dx": 80,
            "fontSize": 13,
            "opacity": 0.5
          },
          "encoding": {
            "text": {"field": "label"}
        }
      },
      {
        "data": {
          "values": [
            {"label": "Resident survey conducted"}
          ]},
          "mark": {
            "type": "text",
            "angle": -90,
            "fill": "black", 
            "align": "center", 
            "baseline": "middle",
            "dy": -180,
            "dx": -80,
            "fontSize": 13,
            "opacity": 0.5
          },
          "encoding": {
            "text": {"field": "label"}
        }
      },
      {
        "data": {
          "values": [
            {"label": "Total tourists"}
          ]},
          "mark": {
            "type": "text",
            "align": "center", 
            "baseline": "middle",
            "dy": -100,
            "dx": 240,
            "color": "darkblue",
            "fontSize": 13,
            "opacity": 1
          },
          "encoding": {
            "text": {"field": "label"}
        }
      },
      {
        "data": {
          "values": [
            {"label": "Townsville/Whitsunday"}
          ]},
          "mark": {
            "type": "text",
            "align": "center", 
            "baseline": "middle",
            "dy": 40,
            "dx": 240,
            "color": "black",
            "fontSize": 13
          },
            "encoding": {
              "text": {"field": "label"},
              "opacity": {"condition": {"test": "hover.Management_Area == 'Townsville/Whitsunday'", "value": 1}, "value": 0.4}
        }
      },
      {
        "data": {
          "values": [
            {"label": "Cairns/Cooktown"}
          ]},
          "mark": {
            "type": "text",
            "align": "center", 
            "baseline": "middle",
            "dy": 120,
            "dx": 240,
            "color": "black",
            "fontSize": 13
          },
            "encoding": {
              "text": {"field": "label"},
              "opacity": {"condition": {"test": "hover.Management_Area == 'Cairns/Cooktown'", "value": 1}, "value": 0.4}
        }
      },
      {
        "data": {
          "values": [
            {"label": "Mackay/Capricorn"}
          ]},
        "mark": {
            "type": "text",
            "align": "center", 
            "baseline": "middle",
            "dy": 160,
            "dx": 240,
            "color": "black",
            "fontSize": 13
          },
           "encoding": {
              "text": {"field": "label"},
              "opacity": {"condition": {"test": "hover.Management_Area == 'Mackay/Capricorn'", "value": 1}, "value": 0.4}
        } },
      {
        "data": {
          "values": [
            {"label": "Far Northern"}
          ]},
          "mark": {
            "type": "text",
            "align": "center", 
            "baseline": "middle",
            "dy": 190,
            "dx": 240,
            "color": "black",
            "fontSize": 13
          },
          "encoding": {
            "text": {"field": "label"},
            "opacity": {"condition": {"test": "hover.Management_Area == 'Far Northern'", "value": 1}, "value": 0.4}
        }
      },
      {
        "mark": "line",
        "encoding": {
            "x": {"field": "Quarter", "type": "temporal", "axis": {"grid": false}},
            "y": {"field": "GBR_visits", "type": "quantitative", "axis": {"grid": false}}
        }
      },{
          "params": [{
          "name": "hover",
          "select": {
            "type": "point",
            "fields": ["Management_Area"],
            "on": "pointermove",
            "nearest": true
              }
          }],
            "mark": {"type": "point", "opacity": 0},
            "encoding": {
                "x": {"field": "Quarter", "type": "temporal"},
                "y": {"field": "visits", "type": "quantitative"}
            }
      },{
        "mark": "line",
        "encoding": {
            "x": {"field": "Quarter", "type": "temporal"},
            "y": {"field": "visits", "type": "quantitative"},
            "color": {
              "field":"Management_Area",
              "type":"nominal",
              "legend": null
            },
            "opacity": {
              "condition": {"param": "hover", "value": 1},
              "value": 0.2}
        }
      }
    ]
  },
{"vconcat": [
  {"hconcat": [
  {
    "title": "Cairns/Cooktown",
    "width": 290,
    "height": 120,
    "encoding": {
      "x": {"axis": {"title": "Time", "grid": false}},
      "y": {"axis": {"title": "Number of tourist visits", "grid": false}}
    },
    "layer": [
      {
        "data": {
          "values": [
            {"label": "Borders close due to COVID-19", "type": "covid", "start": "Mar-Jun 2020", "end": "Jan-Mar 2021"},
            {"label": "Borders close due to COVID-19", "type": "covid", "start": "Jul-Sep 2021", "end": "Jan-Mar 2022"},
            {"label": "Resident survey conducted", "type": "survey", "start": "Apr-Jun 2017", "end": "Jul-Sep 2017"}            
        ]
        },
        "mark": "rect",
        "encoding": {
          "x": {"field": "start", "type": "temporal"},
          "x2": {"field": "end", "type": "temporal"},
          "opacity": {"value": 0.2},
          "color": {"field": "type", "legend": null}
        }
      },      {
        "transform": [
          {"filter": "datum.Management_Area == 'Cairns/Cooktown'"}
        ],
        "mark": "line",
        "encoding": {
            "x": {"field": "Quarter", "type": "temporal"},
            "y": {"field": "visits", "type": "quantitative", "scale": {"domain": [0,400000]}},
            "opacity": {"condition": {"test": "hover.Management_Area == 'Cairns/Cooktown'", "value": 1}, "value": 0.4}
        }
      }
    ]
  },
  {
    "title": "Townsville/Whitsunday",
    "width": 290,
    "height": 120,
    "encoding": {
      "x": {"axis": {"title": "Time", "grid": false}},
      "y": {"axis": {"title": "Number of tourist visits", "grid": false}}
    },
    "layer": [
      {
        "data": {
          "values": [
            {"label": "Borders close due to COVID-19", "type": "covid", "start": "Mar-Jun 2020", "end": "Jan-Mar 2021"},
            {"label": "Borders close due to COVID-19", "type": "covid", "start": "Jul-Sep 2021", "end": "Jan-Mar 2022"},
            {"label": "Resident survey conducted", "type": "survey", "start": "Apr-Jun 2017", "end": "Jul-Sep 2017"}            
        ]
        },
        "mark": "rect",
        "encoding": {
          "x": {"field": "start", "type": "temporal"},
          "x2": {"field": "end", "type": "temporal"},
          "opacity": {"value": 0.2},
          "color": {"field": "type", "legend": null}
        }
      },
      {
        "transform": [
          {"filter": "datum.Management_Area == 'Townsville/Whitsunday'"}
        ],
        "mark": "line",
        "encoding": {
            "x": {"field": "Quarter", "type": "temporal"},
            "y": {"field": "visits", "type": "quantitative", "scale": {"domain": [0,400000]}},
            "opacity": {"condition": {"test": "hover.Management_Area == 'Townsville/Whitsunday'", "value": 1}, "value": 0.4}
        }
      }
    ]
  }]},
  {"hconcat": [
  {
    "title": "Far Northern",
    "width": 290,
    "height": 120,
    "encoding": {
      "x": {"axis": {"title": "Time", "grid": false}},
      "y": {"axis": {"title": "Number of tourist visits", "grid": false}}
    },
    "layer": [
      {
        "data": {
          "values": [
            {"label": "Borders close due to COVID-19", "type": "covid", "start": "Mar-Jun 2020", "end": "Jan-Mar 2021"},
            {"label": "Borders close due to COVID-19", "type": "covid", "start": "Jul-Sep 2021", "end": "Jan-Mar 2022"},
            {"label": "Resident survey conducted", "type": "survey", "start": "Apr-Jun 2017", "end": "Jul-Sep 2017"}            
        ]
        },
        "mark": "rect",
        "encoding": {
          "x": {"field": "start", "type": "temporal"},
          "x2": {"field": "end", "type": "temporal"},
          "opacity": {"value": 0.2},
          "color": {"field": "type", "legend": null}
        }
      },
      {
        "transform": [
          {"filter": "datum.Management_Area == 'Far Northern'"}
        ],
        "mark": "line",
        "encoding": {
            "x": {"field": "Quarter", "type": "temporal"},
            "y": {"field": "visits", "type": "quantitative", "scale": {"domain": [0,60000]}},
            "opacity": {"condition": {"test": "hover.Management_Area == 'Far Northern'", "value": 1}, "value": 0.4}
        }
      }
    ]
  },
  { "title": "Mackay/Capricorn",
    "width": 290,
    "height": 120,
    "encoding": {
      "x": {"axis": {"title": "Time", "grid": false}},
      "y": {"axis": {"title": "Number of tourist visits", "grid": false}}
    },
    "layer": [
      {
        "data": {
          "values": [
            {"label": "Borders close due to COVID-19", "type": "covid", "start": "Mar-Jun 2020", "end": "Jan-Mar 2021"},
            {"label": "Borders close due to COVID-19", "type": "covid", "start": "Jul-Sep 2021", "end": "Jan-Mar 2022"},
            {"label": "Resident survey conducted", "type": "survey", "start": "Apr-Jun 2017", "end": "Jul-Sep 2017"}            
        ]
        },
        "mark": "rect",
        "encoding": {
          "x": {"field": "start", "type": "temporal"},
          "x2": {"field": "end", "type": "temporal"},
          "opacity": {"value": 0.2},
          "color": {"field": "type", "legend": null}
        }
      },
      {
        "transform": [
          {"filter": "datum.Management_Area == 'Mackay/Capricorn'"}
        ],
        "mark": "line",
        "encoding": {
            "x": {"field": "Quarter", "type": "temporal"},
            "y": {"field": "visits", "type": "quantitative", "scale": {"domain": [0,60000]}},
            "opacity": {"condition": {"test": "hover.Management_Area == 'Mackay/Capricorn'", "value": 1}, "value": 0.4}
        }
      }
    ]
  }
]}]}
]}