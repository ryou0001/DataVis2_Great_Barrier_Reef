{
"$schema": "https://vega.github.io/schema/vega-lite/v5.json",
"title": { "text": "Tourist numbers at the GBR" },
"data": {"url": "vegalite_files/data/tourist_numbers.csv"},
"transform": [
  {
    "joinaggregate": [{
      "op": "sum",
      "field": "visits",
      "as": "GBR_visits"
    }],
    "groupby": ["Quarter"]
  }
],
"vconcat": [
  {
    "width": 660,
    "height": 400,
    "layer": [
      {
        "data": {
          "values": [
            {"label": "Borders close due to COVID-19", "start": "Mar-Jun 2020", "end": "Jan-Mar 2021"},
            {"label": "Borders close due to COVID-19", "start": "Jul-Sep 2021", "end": "Jan-Mar 2022"},
            {"label": "Resident survey conducted", "type": "survey", "start": "Apr-Jun 2017", "end": "Jul-Sep 2017"}                 
        ]
        },
        "mark": "rect",
        "encoding": {
          "x": {"field": "start", "type": "temporal"},
          "x2": {"field": "end", "type": "temporal"},
          "opacity": {"value": 0.2},
          "color": {"field": "type"}
        }
      },
      {
        "data": {
          "values": [
            {"label": "Queensland borders closed"}
          ]},
          "mark": {
            "type": "text",
            "angle": -90,
            "fill": "black", 
            "align": "center", 
            "baseline": "middle",
            "dy": 25,
            "dx": 80,
            "fontSize": 13,
            "opacity": 0.5
          },
          "encoding": {
            "text": {"field": "label"}
        }
      },
      {
        "data": {
          "values": [
            {"label": "Queensland borders closed"}
          ]},
          "mark": {
            "type": "text",
            "angle": -90,
            "fill": "black", 
            "align": "center", 
            "baseline": "middle",
            "dy": 95,
            "dx": 80,
            "fontSize": 13,
            "opacity": 0.5
          },
          "encoding": {
            "text": {"field": "label"}
        }
      },
      {
        "data": {
          "values": [
            {"label": "Resident survey conducted"}
          ]},
          "mark": {
            "type": "text",
            "angle": -90,
            "fill": "black", 
            "align": "center", 
            "baseline": "middle",
            "dy": -160,
            "dx": -80,
            "fontSize": 13,
            "opacity": 0.5
          },
          "encoding": {
            "text": {"field": "label"}
        }
      },
      {
        "mark": "line",
        "encoding": {
            "x": {"field": "Quarter", "type": "temporal"},
            "y": {"field": "GBR_visits", "type": "quantitative"}
        }
      },
      {
        "mark": "line",
        "encoding": {
            "x": {"field": "Quarter", "type": "temporal"},
            "y": {"field": "visits", "type": "quantitative"},
            "color": {"field": "Management_Area"},
            "opacity": {"value": 0.2}
        }
      }
    ]
  },
{"vconcat": [
  {"hconcat": [
  {
    "title": "Cairns/Cooktown",
    "width": 220,
    "height": 120,
    "layer": [
            {
        "data": {
          "values": [
            {"label": "Borders close due to COVID-19", "start": "Mar-Jun 2020", "end": "Jan-Mar 2021"},
            {"label": "Borders close due to COVID-19", "start": "Jul-Sep 2021", "end": "Jan-Mar 2022"}            
        ]
        },
        "mark": "rect",
        "encoding": {
          "x": {"field": "start", "type": "temporal"},
          "x2": {"field": "end", "type": "temporal"},
          "opacity": {"value": 0.2}
        }
      },
      {
        "transform": [
          {"filter": "datum.Management_Area == 'Cairns/Cooktown'"}
        ],
        "mark": "line",
        "encoding": {
            "x": {"field": "Quarter", "type": "temporal"},
            "y": {"field": "visits", "type": "quantitative", "scale": {"domain": [0,400000]}}
        }
      }
    ]
  },
  {
    "title": "Townsville/Whitsunday",
    "width": 220,
    "height": 120,
    "layer": [
      {
        "data": {
          "values": [
            {"label": "Borders close due to COVID-19", "start": "Mar-Jun 2020", "end": "Jan-Mar 2021"},
            {"label": "Borders close due to COVID-19", "start": "Jul-Sep 2021", "end": "Jan-Mar 2022"}            
        ]
        },
        "mark": "rect",
        "encoding": {
          "x": {"field": "start", "type": "temporal"},
          "x2": {"field": "end", "type": "temporal"},
          "opacity": {"value": 0.2}
        }
      },
      {
        "transform": [
          {"filter": "datum.Management_Area == 'Townsville/Whitsunday'"}
        ],
        "mark": "line",
        "encoding": {
            "x": {"field": "Quarter", "type": "temporal"},
            "y": {"field": "visits", "type": "quantitative", "scale": {"domain": [0,400000]}}
        }
      }
    ]
  }]},
  {"hconcat": [
  {
    "title": "Far Northern",
    "width": 220,
    "height": 120,
    "layer": [
      {
        "data": {
          "values": [
            {"label": "Borders close due to COVID-19", "start": "Mar-Jun 2020", "end": "Jan-Mar 2021"},
            {"label": "Borders close due to COVID-19", "start": "Jul-Sep 2021", "end": "Jan-Mar 2022"}            
        ]
        },
        "mark": "rect",
        "encoding": {
          "x": {"field": "start", "type": "temporal"},
          "x2": {"field": "end", "type": "temporal"},
          "opacity": {"value": 0.2}
        }
      },
      {
        "transform": [
          {"filter": "datum.Management_Area == 'Far Northern'"}
        ],
        "mark": "line",
        "encoding": {
            "x": {"field": "Quarter", "type": "temporal"},
            "y": {"field": "visits", "type": "quantitative", "scale": {"domain": [0,60000]}}
        }
      }
    ]
  },
  { "title": "Mackay/Capricorn",
    "width": 220,
    "height": 120,
    "layer": [
      {
        "data": {
          "values": [
            {"label": "Borders close due to COVID-19", "type": "covid", "start": "Mar-Jun 2020", "end": "Jan-Mar 2021"},
            {"label": "Borders close due to COVID-19", "type": "covid", "start": "Jul-Sep 2021", "end": "Jan-Mar 2022"},
            {"label": "Resident survey conducted", "type": "survey", "start": "Apr-Jun 2017", "end": "Jul-Sep 2017"}            
        ]
        },
        "mark": "rect",
        "encoding": {
          "x": {"field": "start", "type": "temporal"},
          "x2": {"field": "end", "type": "temporal"},
          "opacity": {"value": 0.2},
          "color": {"field": "type", "legend": null}
        }
      },
      {
        "transform": [
          {"filter": "datum.Management_Area == 'Mackay/Capricorn'"}
        ],
        "mark": "line",
        "encoding": {
            "x": {"field": "Quarter", "type": "temporal"},
            "y": {"field": "visits", "type": "quantitative", "scale": {"domain": [0,60000]}}
        }
      }
    ]
  }
]}]}
]}