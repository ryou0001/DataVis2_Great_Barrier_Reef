{
"$schema": "https://vega.github.io/schema/vega-lite/v5.json",
"width": 600,
"height": 400,
"title": { "text": "Water temperature at different depths in the GBR" },
"data": {
    "url": "vegalite_files/data/water_temp_1m.csv"
    },
"transform": [{"filter": "datum.TEMP > 10"}],
"layer": [
    {
        "mark": {"type": "rect"},
        "data": {
            "values": [
                {
                    "start": "2014-01",
                    "end": "2018-01",
                    "event": "Global mass bleaching event"
                },
                {
                    "start": "2016-02",
                    "end": "2016-04",
                    "event": "2016 mass bleaching event"
                },{
                    "start": "2017-02",
                    "end": "2017-04",
                    "event": "2017 mass bleaching event"
                },
                {
                    "start": "2020-02",
                    "end": "2020-04",
                    "event": "2020 mass bleaching event"
                },{
                    "start": "2022-02",
                    "end": "2022-04",
                    "event": "2022 mass bleaching event"
                }
            ]
        },
        "encoding": {
            "x": {
                "field": "start",
                "timeUnit": "yearmonth"
            },
            "x2": {
                "field": "end",
                "timeUnit": "yearmonth"
            },
            "color": {"value": "red"},
            "opacity": {"value": 0.2},
            "tooltip": {"field": "event"}
        }
    },{
        "data": {"values": {"label": ["WORLDWIDE","BLEACHING EVENT"], "x": "2016", "y": 18}},
        "mark": {"type": "text", "fontSize": 12, "color": "darkgray", "align": "center"},
        "encoding": {
            "text": {"field": "label", "type": "nominal"},
            "x": {"field": "x", "type": "temporal"}, 
            "y": {"field": "y", "type": "quantitative", "scale": {"domain": [16,34]}}}
    },{
        "mark": {"type": "point", "opacity": 0.5},
        "encoding": {
            "x": {"field": "TIME", "type": "temporal"},
            "y": {"field": "TEMP", "type": "quantitative", "scale": {"domain": [16,34]}}, 
            "tooltip": [
                {"field": "TIME", "type": "nominal", "title": "Time"}, 
                {"field": "TEMP", "type": "quantitative", "title": "Temperature"}
            ]
        }
    },{
        "data": {"url": "vegalite_files/data/water_temp_av.csv"},
        "mark": {"type": "line"},
        "encoding": {
            "y": {"field": "average_temp", "type": "quantitative"},
            "x": {"field": "start", "type": "temporal"},
            "x2": {"field": "end", "type": "temporal"},
            "color": {
                "condition": {
                    "test": "datum.average_temp > 27", "value": "red"
                }, "value": "black"},
            "size": {"value": 2},
            "tooltip": [
                {"field": "start", "formatType": "time", "format": "%Y", "title": "Year"},
                {"field": "average_temp", "format": ".2C", "title": "Year's average temperature (Â°C)"}
            ]
        }
    }
]}